2025-03-26 20:30:05,149 - __main__ - INFO - Starting model training pipeline
2025-03-26 20:30:05,149 - __main__ - INFO - Loading processed data
2025-03-26 20:30:05,473 - __main__ - INFO - Using 11679 samples for undersampling (equal to fraud class count)
2025-03-26 20:30:05,473 - __main__ - INFO - Creating a balanced evaluation dataset
2025-03-26 20:30:05,473 - __main__ - INFO - Performing undersampling with 11679 samples from majority class
2025-03-26 20:30:05,538 - __main__ - INFO - Created balanced dataset with 23358 samples
2025-03-26 20:30:05,598 - __main__ - INFO - Saved balanced test set with 4672 samples
2025-03-26 20:30:05,606 - __main__ - INFO - Starting undersampling and RandomForest model training with 10 iterations
2025-03-26 20:30:05,606 - __main__ - INFO - Iteration 1/10
2025-03-26 20:30:05,606 - __main__ - INFO - Performing undersampling with 11679 samples from majority class
2025-03-26 20:30:05,648 - __main__ - INFO - Created balanced dataset with 23358 samples
2025-03-26 20:56:15,511 - __main__ - INFO - Iteration 1 completed - F1 Score: 0.7069
2025-03-26 20:56:15,513 - __main__ - INFO - Iteration 2/10
2025-03-26 20:56:15,513 - __main__ - INFO - Performing undersampling with 11679 samples from majority class
2025-03-26 20:56:15,662 - __main__ - INFO - Created balanced dataset with 23358 samples
2025-03-26 21:59:44,419 - __main__ - INFO - Iteration 2 completed - F1 Score: 0.7109
2025-03-26 21:59:44,422 - __main__ - INFO - Iteration 3/10
2025-03-26 21:59:44,422 - __main__ - INFO - Performing undersampling with 11679 samples from majority class
2025-03-26 21:59:44,806 - __main__ - INFO - Created balanced dataset with 23358 samples
2025-03-26 22:03:05,163 - __main__ - INFO - Iteration 3 completed - F1 Score: 0.7029
2025-03-26 22:03:05,167 - __main__ - INFO - Iteration 4/10
2025-03-26 22:03:05,167 - __main__ - INFO - Performing undersampling with 11679 samples from majority class
2025-03-26 22:03:05,326 - __main__ - INFO - Created balanced dataset with 23358 samples
2025-03-26 22:06:23,321 - __main__ - INFO - Iteration 4 completed - F1 Score: 0.6924
2025-03-26 22:06:23,323 - __main__ - INFO - Iteration 5/10
2025-03-26 22:06:23,323 - __main__ - INFO - Performing undersampling with 11679 samples from majority class
2025-03-26 22:06:23,454 - __main__ - INFO - Created balanced dataset with 23358 samples
2025-03-26 22:09:37,782 - __main__ - INFO - Iteration 5 completed - F1 Score: 0.6975
2025-03-26 22:09:37,784 - __main__ - INFO - Iteration 6/10
2025-03-26 22:09:37,784 - __main__ - INFO - Performing undersampling with 11679 samples from majority class
2025-03-26 22:09:37,909 - __main__ - INFO - Created balanced dataset with 23358 samples
2025-03-26 22:12:53,169 - __main__ - INFO - Iteration 6 completed - F1 Score: 0.708
2025-03-26 22:12:53,171 - __main__ - INFO - Iteration 7/10
2025-03-26 22:12:53,171 - __main__ - INFO - Performing undersampling with 11679 samples from majority class
2025-03-26 22:12:53,272 - __main__ - INFO - Created balanced dataset with 23358 samples
2025-03-26 22:16:08,793 - __main__ - INFO - Iteration 7 completed - F1 Score: 0.7076
2025-03-26 22:16:08,793 - __main__ - INFO - Iteration 8/10
2025-03-26 22:16:08,793 - __main__ - INFO - Performing undersampling with 11679 samples from majority class
2025-03-26 22:16:08,971 - __main__ - INFO - Created balanced dataset with 23358 samples
2025-03-26 22:19:24,982 - __main__ - INFO - Iteration 8 completed - F1 Score: 0.7019
2025-03-26 22:19:24,983 - __main__ - INFO - Iteration 9/10
2025-03-26 22:19:24,983 - __main__ - INFO - Performing undersampling with 11679 samples from majority class
2025-03-26 22:19:25,080 - __main__ - INFO - Created balanced dataset with 23358 samples
2025-03-26 22:22:44,256 - __main__ - INFO - Iteration 9 completed - F1 Score: 0.7038
2025-03-26 22:22:44,259 - __main__ - INFO - Iteration 10/10
2025-03-26 22:22:44,259 - __main__ - INFO - Performing undersampling with 11679 samples from majority class
2025-03-26 22:22:44,380 - __main__ - INFO - Created balanced dataset with 23358 samples
2025-03-26 22:26:20,146 - __main__ - INFO - Iteration 10 completed - F1 Score: 0.6993
2025-03-26 22:26:20,151 - __main__ - INFO - Model Type: RandomForest
2025-03-26 22:26:20,151 - __main__ - INFO - Average Accuracy: 0.7055
2025-03-26 22:26:20,151 - __main__ - INFO - Average Fraud Precision: 0.7089
2025-03-26 22:26:20,151 - __main__ - INFO - Average Fraud Recall: 0.6976
2025-03-26 22:26:20,151 - __main__ - INFO - Average AUC: 0.7055
2025-03-26 22:26:20,151 - __main__ - INFO - Average Fraud F1-score: 0.7031
2025-03-26 22:26:20,151 - __main__ - INFO - F1 Scores: [0.7069, 0.7109, 0.7029, 0.6924, 0.6975, 0.708, 0.7076, 0.7019, 0.7038, 0.6993]
2025-03-26 22:26:20,151 - __main__ - INFO - Max F1 Score: 0.7109
2025-03-26 22:26:20,153 - __main__ - INFO - Starting undersampling and GradientBoosting model training with 10 iterations
2025-03-26 22:26:20,153 - __main__ - INFO - Iteration 1/10
2025-03-26 22:26:20,153 - __main__ - INFO - Performing undersampling with 11679 samples from majority class
2025-03-26 22:26:20,423 - __main__ - INFO - Created balanced dataset with 23358 samples
2025-03-26 22:49:27,506 - __main__ - INFO - Iteration 1 completed - F1 Score: 0.7099
2025-03-26 22:49:27,511 - __main__ - INFO - Iteration 2/10
2025-03-26 22:49:27,511 - __main__ - INFO - Performing undersampling with 11679 samples from majority class
2025-03-26 22:49:27,835 - __main__ - INFO - Created balanced dataset with 23358 samples
2025-03-26 23:12:30,362 - __main__ - INFO - Iteration 2 completed - F1 Score: 0.7104
2025-03-26 23:12:30,398 - __main__ - INFO - Iteration 3/10
2025-03-26 23:12:30,401 - __main__ - INFO - Performing undersampling with 11679 samples from majority class
2025-03-26 23:12:31,627 - __main__ - INFO - Created balanced dataset with 23358 samples
2025-03-26 23:35:37,299 - __main__ - INFO - Iteration 3 completed - F1 Score: 0.7095
2025-03-26 23:35:37,301 - __main__ - INFO - Iteration 4/10
2025-03-26 23:35:37,302 - __main__ - INFO - Performing undersampling with 11679 samples from majority class
2025-03-26 23:35:37,444 - __main__ - INFO - Created balanced dataset with 23358 samples
2025-03-26 23:58:37,186 - __main__ - INFO - Iteration 4 completed - F1 Score: 0.6984
2025-03-26 23:58:37,190 - __main__ - INFO - Iteration 5/10
2025-03-26 23:58:37,190 - __main__ - INFO - Performing undersampling with 11679 samples from majority class
2025-03-26 23:58:37,357 - __main__ - INFO - Created balanced dataset with 23358 samples
2025-03-27 00:21:39,416 - __main__ - INFO - Iteration 5 completed - F1 Score: 0.7193
2025-03-27 00:21:39,421 - __main__ - INFO - Iteration 6/10
2025-03-27 00:21:39,421 - __main__ - INFO - Performing undersampling with 11679 samples from majority class
2025-03-27 00:21:39,736 - __main__ - INFO - Created balanced dataset with 23358 samples
2025-03-27 00:44:50,018 - __main__ - INFO - Iteration 6 completed - F1 Score: 0.6945
2025-03-27 00:44:50,021 - __main__ - INFO - Iteration 7/10
2025-03-27 00:44:50,021 - __main__ - INFO - Performing undersampling with 11679 samples from majority class
2025-03-27 00:44:50,259 - __main__ - INFO - Created balanced dataset with 23358 samples
2025-03-27 01:07:48,823 - __main__ - INFO - Iteration 7 completed - F1 Score: 0.7067
2025-03-27 01:07:48,827 - __main__ - INFO - Iteration 8/10
2025-03-27 01:07:48,827 - __main__ - INFO - Performing undersampling with 11679 samples from majority class
2025-03-27 01:07:49,082 - __main__ - INFO - Created balanced dataset with 23358 samples
2025-03-27 01:30:10,288 - __main__ - INFO - Iteration 8 completed - F1 Score: 0.7125
2025-03-27 01:30:10,289 - __main__ - INFO - Iteration 9/10
2025-03-27 01:30:10,289 - __main__ - INFO - Performing undersampling with 11679 samples from majority class
2025-03-27 01:30:10,409 - __main__ - INFO - Created balanced dataset with 23358 samples
2025-03-27 07:31:59,208 - __main__ - INFO - Iteration 9 completed - F1 Score: 0.7053
2025-03-27 07:31:59,211 - __main__ - INFO - Iteration 10/10
2025-03-27 07:31:59,211 - __main__ - INFO - Performing undersampling with 11679 samples from majority class
2025-03-27 07:31:59,460 - __main__ - INFO - Created balanced dataset with 23358 samples
2025-03-27 07:54:12,737 - __main__ - INFO - Iteration 10 completed - F1 Score: 0.7087
2025-03-27 07:54:12,738 - __main__ - INFO - Model Type: GradientBoosting
2025-03-27 07:54:12,738 - __main__ - INFO - Average Accuracy: 0.7080
2025-03-27 07:54:12,738 - __main__ - INFO - Average Fraud Precision: 0.7089
2025-03-27 07:54:12,738 - __main__ - INFO - Average Fraud Recall: 0.7063
2025-03-27 07:54:12,738 - __main__ - INFO - Average AUC: 0.7080
2025-03-27 07:54:12,738 - __main__ - INFO - Average Fraud F1-score: 0.7075
2025-03-27 07:54:12,739 - __main__ - INFO - F1 Scores: [0.7099, 0.7104, 0.7095, 0.6984, 0.7193, 0.6945, 0.7067, 0.7125, 0.7053, 0.7087]
2025-03-27 07:54:12,739 - __main__ - INFO - Max F1 Score: 0.7193
2025-03-27 07:54:12,739 - __main__ - INFO - Starting undersampling and XGBoost model training with 10 iterations
2025-03-27 07:54:12,739 - __main__ - INFO - Iteration 1/10
2025-03-27 07:54:12,739 - __main__ - INFO - Performing undersampling with 11679 samples from majority class
2025-03-27 07:54:12,875 - __main__ - INFO - Created balanced dataset with 23358 samples
2025-03-27 07:54:22,590 - __main__ - INFO - Iteration 1 completed - F1 Score: 0.7213
2025-03-27 07:54:22,591 - __main__ - INFO - Iteration 2/10
2025-03-27 07:54:22,591 - __main__ - INFO - Performing undersampling with 11679 samples from majority class
2025-03-27 07:54:22,691 - __main__ - INFO - Created balanced dataset with 23358 samples
2025-03-27 07:54:33,416 - __main__ - INFO - Iteration 2 completed - F1 Score: 0.7094
2025-03-27 07:54:33,416 - __main__ - INFO - Iteration 3/10
2025-03-27 07:54:33,416 - __main__ - INFO - Performing undersampling with 11679 samples from majority class
2025-03-27 07:54:33,465 - __main__ - INFO - Created balanced dataset with 23358 samples
2025-03-27 07:54:44,341 - __main__ - INFO - Iteration 3 completed - F1 Score: 0.718
2025-03-27 07:54:44,342 - __main__ - INFO - Iteration 4/10
2025-03-27 07:54:44,342 - __main__ - INFO - Performing undersampling with 11679 samples from majority class
2025-03-27 07:54:44,413 - __main__ - INFO - Created balanced dataset with 23358 samples
2025-03-27 07:54:54,749 - __main__ - INFO - Iteration 4 completed - F1 Score: 0.7094
2025-03-27 07:54:54,750 - __main__ - INFO - Iteration 5/10
2025-03-27 07:54:54,750 - __main__ - INFO - Performing undersampling with 11679 samples from majority class
2025-03-27 07:54:54,836 - __main__ - INFO - Created balanced dataset with 23358 samples
2025-03-27 07:55:04,815 - __main__ - INFO - Iteration 5 completed - F1 Score: 0.7128
2025-03-27 07:55:04,816 - __main__ - INFO - Iteration 6/10
2025-03-27 07:55:04,816 - __main__ - INFO - Performing undersampling with 11679 samples from majority class
2025-03-27 07:55:04,866 - __main__ - INFO - Created balanced dataset with 23358 samples
2025-03-27 07:55:14,963 - __main__ - INFO - Iteration 6 completed - F1 Score: 0.7117
2025-03-27 07:55:14,963 - __main__ - INFO - Iteration 7/10
2025-03-27 07:55:14,963 - __main__ - INFO - Performing undersampling with 11679 samples from majority class
2025-03-27 07:55:15,007 - __main__ - INFO - Created balanced dataset with 23358 samples
2025-03-27 07:55:24,548 - __main__ - INFO - Iteration 7 completed - F1 Score: 0.7096
2025-03-27 07:55:24,549 - __main__ - INFO - Iteration 8/10
2025-03-27 07:55:24,549 - __main__ - INFO - Performing undersampling with 11679 samples from majority class
2025-03-27 07:55:24,645 - __main__ - INFO - Created balanced dataset with 23358 samples
2025-03-27 07:55:34,723 - __main__ - INFO - Iteration 8 completed - F1 Score: 0.7176
2025-03-27 07:55:34,724 - __main__ - INFO - Iteration 9/10
2025-03-27 07:55:34,724 - __main__ - INFO - Performing undersampling with 11679 samples from majority class
2025-03-27 07:55:34,765 - __main__ - INFO - Created balanced dataset with 23358 samples
2025-03-27 07:55:43,614 - __main__ - INFO - Iteration 9 completed - F1 Score: 0.7055
2025-03-27 07:55:43,615 - __main__ - INFO - Iteration 10/10
2025-03-27 07:55:43,615 - __main__ - INFO - Performing undersampling with 11679 samples from majority class
2025-03-27 07:55:43,660 - __main__ - INFO - Created balanced dataset with 23358 samples
2025-03-27 07:55:56,199 - __main__ - INFO - Iteration 10 completed - F1 Score: 0.7052
2025-03-27 07:55:56,201 - __main__ - INFO - Model Type: XGBoost
2025-03-27 07:55:56,201 - __main__ - INFO - Average Accuracy: 0.7129
2025-03-27 07:55:56,201 - __main__ - INFO - Average Fraud Precision: 0.7141
2025-03-27 07:55:56,201 - __main__ - INFO - Average Fraud Recall: 0.7102
2025-03-27 07:55:56,201 - __main__ - INFO - Average AUC: 0.7129
2025-03-27 07:55:56,201 - __main__ - INFO - Average Fraud F1-score: 0.7121
2025-03-27 07:55:56,201 - __main__ - INFO - F1 Scores: [0.7213, 0.7094, 0.718, 0.7094, 0.7128, 0.7117, 0.7096, 0.7176, 0.7055, 0.7052]
2025-03-27 07:55:56,201 - __main__ - INFO - Max F1 Score: 0.7213
2025-03-27 07:55:57,308 - __main__ - INFO - Best RandomForest F1 on balanced test set: 0.7198
2025-03-27 07:55:57,308 - __main__ - INFO - Best GradientBoosting F1 on balanced test set: 0.7840
2025-03-27 07:55:57,308 - __main__ - INFO - Best XGBoost F1 on balanced test set: 0.7579
2025-03-27 07:55:57,363 - __main__ - INFO - Best models saved to models/ directory
2025-03-27 07:55:57,409 - __main__ - INFO - Model: RandomForest
2025-03-27 07:55:57,410 - __main__ - INFO - Accuracy: 0.7170
2025-03-27 07:55:57,410 - __main__ - INFO - Precision: 0.7128
2025-03-27 07:55:57,410 - __main__ - INFO - Recall: 0.7269
2025-03-27 07:55:57,410 - __main__ - INFO - F1-Score: 0.7198
2025-03-27 07:55:57,410 - __main__ - INFO - AUC: 0.7894
2025-03-27 07:55:57,410 - __main__ - INFO - Confusion Matrix:
[[1652  684]
 [ 638 1698]]
2025-03-27 07:55:58,264 - __main__ - INFO - Model: GradientBoosting
2025-03-27 07:55:58,265 - __main__ - INFO - Accuracy: 0.7697
2025-03-27 07:55:58,265 - __main__ - INFO - Precision: 0.7381
2025-03-27 07:55:58,265 - __main__ - INFO - Recall: 0.8360
2025-03-27 07:55:58,265 - __main__ - INFO - F1-Score: 0.7840
2025-03-27 07:55:58,265 - __main__ - INFO - AUC: 0.8438
2025-03-27 07:55:58,265 - __main__ - INFO - Confusion Matrix:
[[1643  693]
 [ 383 1953]]
2025-03-27 07:55:58,411 - __main__ - INFO - Model: XGBoost
2025-03-27 07:55:58,411 - __main__ - INFO - Accuracy: 0.7474
2025-03-27 07:55:58,411 - __main__ - INFO - Precision: 0.7277
2025-03-27 07:55:58,411 - __main__ - INFO - Recall: 0.7907
2025-03-27 07:55:58,411 - __main__ - INFO - F1-Score: 0.7579
2025-03-27 07:55:58,411 - __main__ - INFO - AUC: 0.8231
2025-03-27 07:55:58,411 - __main__ - INFO - Confusion Matrix:
[[1645  691]
 [ 489 1847]]
2025-03-27 07:55:58,537 - __main__ - INFO - Overall best model: GradientBoosting with F1 Score: 0.7840
2025-03-27 07:55:58,538 - __main__ - INFO - Model metrics saved to reports/model_metrics.json
2025-03-27 07:55:58,538 - __main__ - INFO - Model summary saved to reports/model_summary.json
2025-03-27 07:55:58,538 - __main__ - INFO - Model training pipeline completed successfully
